.TH S9S-USER 1 "August 29, 2016"

.SH NAME
s9s-user \- Command line client for the Severalnines Clustercontrol server.
.SH SYNOPSIS
.B s9s-cluster
.RI [OPTION]...
.RI [USERNAME]...
.SH DESCRIPTION
\fBs9s\fP  is a command line tool for ClusterControl, which can be used to
deploy and operate MySQL, MariaDB, MongoDB and PostgreSQL.

.SH OPTIONS
.SS "Main Option"
The application should always be started using a main option that sets what
operation should be performed. This "main option" should be one of the
following:

.TP 
.B \-\^\-add\-key
Register a new public key for an existing user.

.TP 
.B \-\^\-change\-password
Change the password of an existing user.

.TP
.B \-\^\-create
Register a new user (create a new user account) on the controller and grant
access to the ClusterControl system. The user name of the new account should be
the command line argument. Please check the EXAMPLES section of this
documentation for some examples.

.TP
.B \-L, \-\^\-list
List the users registered for the ClusterControl controller. 

.TP
.B \-\-list\-groups
List the user groups maintained by the ClusterControl controller.

.TP
.B \-\^\-list\-keys
Lists the public keys registered in the controller for the specified user.
Please note that viewing the public keys require special privileges, normal
users can not view the public keys of other users.

.TP
.B \-\^\-set
Changes the specified properties of the user.

.TP
.B \-\^\-whoami
Same as \fB\-\-list\fR, but only lists the current user, the user that
authenticated on the controller.

.SS Generic Options

.TP
.B \-\^\-help
Print the help message and exist.

.TP
.B \-\^\-debug
Print even the debug level messages.

.TP
.B \-v, \-\^\-verbose
Print more messages than normally.

.TP
.B \-V, \-\^\-version
Print version information and exit.

.TP
.BR \-c " [\fIPROT\fP://]\fIHOSTNAME\fP[:\fIPORT\fP]" "\fR,\fP \-\^\-controller=" [\fIPROT\fP://]\\fIHOSTNAME\fP[:\fIPORT\fP]
The host name of the Cmon Controller. The protocol and port is also accepted as
part of the hostname (e.g. --controller="https://127.0.0.1:9556").

.TP
.BI \-P " PORT" "\fR,\fP \-\^\-controller-port=" PORT
The port where the Cmon Controller is waiting for connections.

.TP
.BI \-u " USERNAME" "\fR,\fP \-\^\-cmon\-user=" USERNAME
Sets the name of the Cmon user (the name of the account maintained by the Cmon
Controller) to be used to authenticate. Since most of the functionality needs
authentication this command line option should be very frequently used or set in
the configuration file. Please check the documentation of the s9s.conf(5) to see
how the Cmon User can be set using the \fBcmon_user\fP configuration variable.

.TP
.BI \-p " PASSWORD" "\fR,\fP \-\^\-password=" PASSWORD
The password for the Cmon User (whose user name is set using the 
\fB\-\^\-cmon\-user\fP command line option or using the \fBcmon_user\fP
configuration value). Providing the password is not mandatory, the user
authentication can also be done using a private/public keypair automatically.

.TP
.BI \-\^\-private\-key\-file= FILE
The path to the private key file that will be used for the authentication.

.TP
.B \-l, \-\^\-long
This option is similar to the -l option for the standard ls UNIX utility
program. If the program creates a list of objects this option will change its
format to show more details.

.TP
.B \-\^\-print-json
The JSON strings will be printed while communicating with the controller. This 
option is for debugging purposes.

.TP
.BR \-\^\-color [ =\fIWHEN\fP "]
Turn on and off the syntax highlighting of the output. The supported values for 
.I WHEN
is
.BR never ", " always ", or " auto .

.TP
.B \-\^\-batch
Print no messages. If the application created a job print only the job ID number
and exit. If the command prints data do not use syntax highlight, headers,
totals, only the pure table to be processed using filters.

.TP
.B \-\^\-no\-header
Do not print headers for tables.

.\"
.\"
.\"
.SS Options Related to Users

.TP
.BI \-\^\-group= GROUPNAME
Set the name of the group. For example when a new user is created this option
can be used to control what will be the primary group of the new user.

.TP
.BI \-\^\-create\-group
If this command line option is provided and the group for the new user does not
exist the group will be created together with the new user.

.TP
.BI \-\^\-first\-name= NAME
Set the first name of the user.

.TP
.BI \-\^\-last\-name= NAME
Set the last name of the user.

.TP
.BI \-\^\-public\-key\-file= FILENAME 
The name of the file where the public key is stored. Please note that this
currently only works with the \fB\-\^\-add\-key\fP option.

.TP
.BI \-\^\-title= TITLE
The title prefix (e.g. Dr.) for the user.

.TP
.BI \-\^\-email\-address= ADDRESS
The email address for the user.

.TP
.BI \-\^\-new\-password= PASSWORD
The new password when changing the password.

.TP
.BI \-\^\-old\-password= PASSWORD
The old password when changing the password.

.\"
.\" The user format string.
.\"
.TP
.BR \-\^\-user\-format [ =\fIFORMATSTRING\fP "]
The string that controls the format of the printed information about the users.
When this command line option is used the specified information will be printed
instead of the default columns. The format string uses the '%' character to mark
variable fields and flag characters as they are specified in the standard
printf() C library functions. The '%' specifiers are ended by field name letters
to refer to various properties of the users.

The "%+12I" format string for example has the "+12" flag characters in it with
the standard meaning: the field will be 12 character wide and the "+" or "-"
sign will always be printed with the number. 

The properties of the user are encoded by letters. The in the "%16N" for
example the letter "N" encodes the "username" field, so username of the user
will be substituted. 

Standard '\\' notation is also available, \\n for example encodes a new-line 
character.

The s9s-tools support the following fields:

.RS 7

.TP
.B F
The full name of the user.

.TP
.B f
The first name of the user.

.TP
.B G
The names of groups the given user belongs to.

.TP
.B I
The unique numerical ID of the user.

.TP 
.B j
The job title of the user.

.TP
.B l
The last name of the user.

.TP
.B M
The email address of the user.

.TP
.B m
The middle name of the user.

.TP
.B N
The username for the user.

.TP
.B t
The title of the user (e.g. "Dr.").

.RE


.\"
.\"
.\"
.SH USER LIST
Using the \fB\-\-list\fP and \fB\-\-long\fP command line options a detailed list
of the users can be printed. Here is an example of such a list:

.nf
# \fBs9s user --list --long worf jadzia\fP
A ID UNAME  GNAME EMAIL           REALNAME
- 11 jadzia ds9   dax@ds9.com     Lt. Jadzia Dax
A 12 worf   ds9   warrior@ds9.com Lt. Worf
Total: 12

.fi

Please note that there are a total of 12 users defined on the system, but only
two of those are printed because we filtered the list with the command line
arguments.

The list contain the following fields:
.RS 5

.TP
.B A
Shows the authentication status. If this field shows the letter 'A' the user is
authenticated with the current connection.

.TP 
.B ID
Shows the user ID, a unique numerical ID identifying the user.

.TP 
.B UNAME
The username.

.TP
.B GNAME
The name of the primary group of the user. All user belongs to at least one
group, the primary group.

.TP
.B EMAIL
The email address of the user.

.TP
.B REALNAME
The real name of the user that consists first name, last name and some other
parts, printed here as a single string composed all the available components.

.RE

.\"
.\"
.\"
.SH ENVIRONMENT
The s9s application will read and consider the following environment variables:
.TP 5 
CMON_CONTROLLER
The host name and optionally the port number of the controller that will be
contacted. This also can be set using the \fB\-\-controller\fR command line
option.

.TP 5
CMON_CLUSTER_ID
The numerical ID of the cluster to control, same as the \fB\-\-cluster\-id\fR
command line option.

.\" 
.\" The examples. The are very helpful for people just started to use the
.\" application.
.\" 
.SH EXAMPLES
.PP
The first example will create a new user (if it is not yet created), set some
properties for the new user (like the first name and the last name) and grant
acess to the system using a public SSL key that is created (if it is not yet
created):

.nf
# \fBs9s user \\
    --create \\
    --generate-key \\
    --first-name="John" \\
    --last-name="Doe" \\
    --group=admins \\
    john\fR
.fi

Here is how to get a detailed list of the users managed by the controller.

# \fBs9s user \\
    --list \\
    --long\fR

The following example shows how one user can change the email address of an
other (existing) user. 

.nf
# \fBs9s user \\
    --set \\
    --email-address=newemail@ds9.com \\
    worf
\fR
.fi

